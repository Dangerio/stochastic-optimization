# Применение генетического алгоритма для задачи линейного программирования 
Будет решаться следующая задача линейного программирования, которую можно себе представлять как задачу о максимизации прибыли от продажи товаров для некоторой фирмы при условии технологических ограничений и ограничений на имеющиеся запасы ресурсов.

$$
f(x) = c^T x \rightarrow \underset{x \in \mathbb{R}^n}{\max} 
$$

$$
Ax \leqslant b 
$$

$$
x_i \geqslant 0  \text{ } \forall i = 1, \dots, n
$$

$$
x_i \in \mathbb{Z}  \text{ }  \forall i \in Z
$$

где 

$A \in Mat_{m \text{ } n}(\mathbb{R}_+)$

$b \in \mathbb{R}_+^m$

$c \in \mathbb{R}_+^n$

Z - подмножество множества натуральных чисел от 1 до $n$.

Для ее решения будет использован генетический алгоритм:
1) Генерация популяции генов случайным образом.
2) Подсчет функции приспособленности гена $fit(x) = с^T x \cdot \mathbb{I}(Ax \leqslant b) \cdot \mathbb{I}(x_i \geqslant 0  \text{ } \forall i = 1, \dots, n) \cdot \mathbb{I}(x_i \in \mathbb{Z}  \text{ }  \forall i \in Z)$ и сортировка популяции по убыванию значений приспособленности.
3) Замена каждой особи с номером $m \in [2, M - M_c]$ на результат ее скрещивания со случайной особью в пуле. 

    Скрещивание двух генов $x, y \in \mathbb{R}^n$ подразумевает создание нового гена $z$, где каждая хромосома $z_i$ будет взята случайно из множества $\{x_i, y_i\}$, причем $\mathbb{P}(z_i = x_i) = \frac{fit(x)}{fit(x) + fit(y)}$.

4) Замена $M_c$ наименее приспособленных особей случайно сгенерированными генами.
5) Возврат к шагу 2, если количество итераций не достигло $L$.

Для реализации данного алгоритма были использованы следующие функции:


* ```gen_alg_lp(A, c, b, int_idx, M, M_c, L)``` - функция, реализующая генетический алгоритм для решения задачи линейного программирования.

    * **Вход**: 
      * $A$ - технологическая матрица размера $m \times n$.
      * $c$ - вектор цен продаваемых товаров длины $n$.
      * $b$ - вектор запасов ресурсов длины $m$.
      * $int\_idx$ - вектор индексов целочисленных переменных, то есть номера товаров, количества которых могут быть только целыми.
      * $M$ - размер популяции.
      * $M_c$ - количество "убиваемых" особей на каждой итерации алгоритма.
      * $L$ - максимальное количество итераций алгоритма.

    * **Выход**:  
      * $y$ - найденная максимальная прибыль (значение $f(x)$).
      * $x$ - оптимальные объемы производства (значение $x$).
* ```gen_alg_lp_test ``` - скрипт, содержащий в себе набор тестов для вышеописанного генетического алгоритма.

Пример использования (сравнение результатов симплекс-метода и генетического алгоритма):
```
>> A = [[10, 20, 30]; [60, 20, 10]; [35.4, 40.2, 50]];
b = [1000, 750, 830.5]';
c = [30, 15, 22.5]';
int_idx = [2, 3];
>> simp_meth = intlinprog(-c, int_idx, A, b ,[], [] , zeros(3, 1))
LP:                Optimal objective value is -528.968254.                                          

Heuristics:        Found 2 solutions using ZI round.                                                
Upper bound is -511.009070.                                                      
Relative gap is 2.72%.                                                          

Cut Generation:    Applied 1 mir cut.                                                               
Lower bound is -524.957627.                                                      
Relative gap is 0.00%.                                                          


Optimal solution found.

Intlinprog stopped at the root node because the objective value is within a gap tolerance of the optimal value,
options.AbsoluteGapTolerance = 0 (the default value). The intcon variables are integer within tolerance,
options.IntegerTolerance = 1e-05 (the default value).


simp_meth =

10.7486
0
9.0000

>> [~, x_best] = gen_alg_lp(A, c, b, int_idx, M, M_c, L)

x_best =

10.7450         0    9.0000
```